package com.myCompany.hibernate_crud_demo.dao;

import org.hibernate.*;

import com.myCompany.hibernate_crud_demo.factory.MyHibernateFactory;
import com.myCompany.hibernate_crud_demo.shared.SharedEmployee;

public class EmployeeDAOImpl {
private Session session = null;

public EmployeeDAOImpl() {
	super();
	session = MyHibernateFactory.getMySession();
	// TODO Auto-generated constructor stub
}

@Override
public void createEmployee(SharedEmployee sEmployee) {
	// TODO Auto-generated method stub
	
	ModelMapper mapper=new ModelMapper();
	Employee employee=mapper.map(sEmployee, Employee.class);
	UUID uUid=UUID.randomUUID();
	employee.setGeneratedId(uUid.toString());
	session.getTransaction().begin();
	session.save(employee);
	session.getTransaction().commit();

}

@Override
public List<SharedEmployee> getAllEmployee() {
	// TODO Auto-generated method stub
	ModelMapper mapper=new ModelMapper();
	session.getTransaction().begin();
	Query query=session.createQuery("from Employee");
	session.getTransaction().commit();
	@SuppressWarnings("unchecked")
	List<Employee> list1=query.getResultList();
	List<SharedEmployee> sList=new ArrayList<SharedEmployee>();
	for(Employee e:list1)
	{
		SharedEmployee se=mapper.map(e, SharedEmployee.class);
		sList.add(se);
	}
	
	return sList;
}
}
